import psycopg2

def add_product():
    conn = psycopg2.connect(
        host="localhost",     # Use localhost
        database="postgres",  # Replace with your actual database name
        user="postgres",      # PostgreSQL username
        password="Root@2024"     # Password for postgres user
    )
    
    try:
        conn.set_isolation_level(3)  # SERIALIZABLE isolation level
        conn.autocommit = False      # Disable autocommit
        cur = conn.cursor()

        # Transaction 1: Add product (P100, cd, 5) in Product
        cur.execute("""
            INSERT INTO product (prodid, pname, price) 
            VALUES ('P100', 'cd', 5)
            ON CONFLICT (prodid) DO NOTHING
        """)

        # Commit the transaction
        conn.commit()
        print("Product P100 added successfully!")

    except (Exception, psycopg2.DatabaseError) as error:
        print("Error occurred:", error)
        conn.rollback()  # Rollback in case of error

    finally:
        cur.close()
        conn.close()
        print("PostgreSQL connection closed.")

add_product()
